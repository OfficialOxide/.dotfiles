\usepackage[x11names, svgnames, dvipsnames]{xcolor}
\usepackage{amsmath, amssymb, amsthm}
\usepackage{graphicx}
%\usepackage{mathtools}
\usepackage{mathrsfs}
\usepackage[shortlabels]{enumitem}
\newcommand{\vocab}[1]{\textit{#1}}
\usepackage[]{fontspec}
\usepackage{microtype}
\usepackage{tikz-cd}
\usepackage{tikz}
\usepackage[]{quiver}
\usetikzlibrary{arrows, arrows.meta}
\tikzcdset{ arrows={line width=0.42pt}, arrow style=tikz, diagrams={>={Stealth[round,length=3.5pt,width=3.75pt,inset=1.8pt]}},line width=2pt}



%Don't allow libertinus-otf to change script font
\usepackage[]{hyperref}


\hypersetup{colorlinks, % Don't put a box around links
breaklinks,             % Allow line breaks inside links
linkcolor=DodgerBlue3!80!black,        % Cross-references to theorems etc
urlcolor=black}         % Web addresses


\newfontfamily\sscfont{Minion Pro}[SmallCapsFeatures={LetterSpace=14, WordSpace=2}]
%%% Sections
\RedeclareSectionCommands[
  beforeskip=\baselineskip,
  afterskip=1.4\baselineskip,
  ]{section}


\renewcommand*{\subsectionformat}%
  {\scshape\upshape\thesubsection\enskip}

%%% Title
\addtokomafont{subtitle}{\scshape\normalsize}
\setkomafont{title}{\normalfont\rmfamily\mdseries}
\setkomafont{author}{\large}
\setkomafont{date}{\normalsize}
\setkomafont{section}{\sscfont\scshape\mdseries\large\MakeLowercase}
\setkomafont{subsection}{\mdseries\itshape\normalsize\rmfamily}
%%% Page setup
\usepackage[headsepline]{scrlayer-scrpage}
\renewcommand{\headfont}{}
\addtolength{\textheight}{3.14cm}
\setlength{\footskip}{0.5in}
\setlength{\headsep}{12pt}
\automark{section}
\ohead{\footnotesize\pagemark}
\chead{}
\ihead{\footnotesize\@title}
\cfoot{\pagemark}

\makeatletter
\patchcmd{\@maketitle}{\titlefont\huge}{\titlefont\normalsize}{}{}
\makeatother

\usepackage{thmtools}

% Theorems
\declaretheoremstyle[
  headfont=\bfseries,
  spaceabove=3pt,
  spacebelow=2pt,
  ]{thmpurbox}

% Remarks
\declaretheoremstyle[
	headfont=\bfseries,
	bodyfont=\normalfont\small,
	spaceabove=3pt,
	spacebelow=0pt,
]{thmblackbox}

% numbered environments
\declaretheorem[style=thmpurbox,name=Theorem,numberwithin=section]{theorem}
\declaretheorem[style=thmpurbox,name=Definition,sibling=theorem]{definition}
\declaretheorem[style=thmpurbox,name=Lemma,sibling=theorem]{lemma}
\declaretheorem[style=thmpurbox,name=Proposition,sibling=theorem]{proposition}
\declaretheorem[style=thmpurbox,name=Corollary,sibling=theorem]{corollary}
\declaretheorem[style=thmpurbox,name=Algorithm,sibling=theorem]{algorithm}
\declaretheorem[style=thmpurbox,name=Claim,sibling=theorem]{claim}
\declaretheorem[style=thmpurbox,name=Example,sibling=theorem]{example}
\declaretheorem[style=thmpurbox,name=Question,sibling=theorem]{ques}

\declaretheorem[style=thmblackbox,name=Remark,sibling=theorem]{remark}
\declaretheorem[style=thmblackbox,name=Exercise]{exercise}
\declaretheorem[style=thmpurbox,name=Problem,sibling=exercise]{problem}

% unnumbered envs
\declaretheorem[style=thmpurbox,name=Definition,numbered=no]{definition*}
\declaretheorem[style=thmpurbox,name=Theorem,numbered=no]{theorem*}
\declaretheorem[style=thmpurbox,name=Lemma,numbered=no]{lemma*}
\declaretheorem[style=thmpurbox,name=Proposition,numbered=no]{proposition*}
\declaretheorem[style=thmpurbox,name=Corollary,numbered=no]{corollary*}
\declaretheorem[style=thmpurbox,name=Algorithm,numbered=no]{algorithm*}
\declaretheorem[style=thmpurbox,name=Claim,numbered=no]{claim*}
\declaretheorem[style=thmpurbox,name=Example,numbered=no]{example*}
\declaretheorem[style=thmpurbox,name=Exercise, numbered=no]{exercise*}
\declaretheorem[style=thmpurbox,name=Problem,numbered=no]{problem*}
\declaretheorem[style=thmpurbox,name=Question, numbered=no]{ques*}

\declaretheorem[style=thmblackbox,name=Remark,numbered=no]{remark*}

\newtheorem{conjecture}[theorem]{Conjecture}
%\newtheorem*{conjecture*}{Conjecture}

\def\<#1>{\mathop{\mathrm{#1}}}
\DeclareMathOperator{\im}{im}
\DeclareMathOperator{\id}{id}
\DeclareMathOperator{\Hom}{Hom}
\DeclareMathOperator{\Spec}{Spec} % spectrum
\newcommand{\km}{\mathfrak m}
\newcommand{\kp}{\mathfrak p}
\newcommand{\kq}{\mathfrak q}
\newcommand{\bA}{\mathbb{A}}

\everymath{\displaystyle}


\usepackage{unicode-math}

\setmainfont{Minion Pro}
\setsansfont{Libertinus Sans}
% ss08 is for slanted integral symbol
\setmathfont[RawFeature = +ss08]{Libertinus Math}
\setmathfont[version = bold, RawFeature = {embolden = 3, +ss08}]{Libertinus Math}

\setmathfont[range = { bb, up, it, \mathbin, \mathord, \mathrel}]{Minion Math}[SizeFeatures = {{Size =-6.01,  Font = MinionMath-Tiny},{Size =  6.01-8.41,  Font = MinionMath-Capt},{Size =  8.41-13.01, Font = MinionMath-Regular},{Size = 13.01-19.91, Font = MinionMath-Subh},{Size = 19.91-,Font = MinionMath-Disp}}]

% normal script fonts
\DeclareSymbolFont{rsfs}{U}{rsfs}{m}{n}
\DeclareSymbolFontAlphabet{\mathscr}{rsfs}

\renewcommand{\qedsymbol}{$\spadesuit$}
